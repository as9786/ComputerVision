# Weighted Boxes Fusion

- 객체 탐지 작업에서 여러 모형을 통해 추론된 경계 상자들을 ensemble하는 방법

![image](https://github.com/as9786/ComputerVision/assets/80622859/03ff3c70-78af-46d8-86b3-77219d2cb53c)

- WBF는 NMS와 다르게 예측된 경계 상자를 모두 사용해서 더 나은 경계 상자를 만들어 나가는 과정을 거침

## 방법

1. B : 한 사진에 대한 모든 경계 상자 정보를 점수를 기준으로 정렬한 list 생성
2. L : 같은 객체에 대한 상자 군집 list, F: 하나의 상자 군집의 평균 상자를 저장할 list
3. NMS처럼 B의 상자들을 순차적으로 반복하여, IoU 값이 특정 임계값 이상인지 판단(첫 상자를 F의 첫 위치에 넣고 다음 상자들에 더해 IoU 갑 확인. 논문에서는 임게값=0.55)
4-1. IoU 값이 임계값보다 작다면, 해당 객체에 대한 경계 군집을 모두 찾았다고 간주하고, 다음 객체에 대한 상자들을 찾음. 즉, 그 상자를 L과 F의 다음 위치에 추가
4-2. IoU 값이 임계값보다 크다면, 해당 상자를 L의 현재 위치에 추가
5. L에 상자가 추가될 때마다, 평균 상자 좌표와 confidence score를 다시 계산. C(평균 confidence score)는 군집의 모든 confidence score의 평균. 이후 평균 상자 좌표를 계산하는데, 이 때 각 상자의 confidence score를 가중치로 함. 점수가 클수록 상자 위치에 대한 영향력이 큼
6. B의 모든 상자들이 제거되면, F의 평균 상자들의 confidence score를 다시 계산. 해당 군집의 상자들의 수를 곱해주고, 전체 모형의 수로 나누어줌
7. 
